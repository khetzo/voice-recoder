<!DOCTYPE html>
<html>
<head>
  <title>Voice Listener</title>
  <style>
    .container {
      display: flex;
      flex-direction: column;
      align-items: center;
      margin-top: 50px;
    }

    .record-button {
      padding: 10px 20px;
      background-color: #f44336;
      color: white;
      border: none;
      font-size: 16px;
      cursor: pointer;
    }

    .recording {
      animation: pulse 1s infinite;
    }

    @keyframes pulse {
      0% { transform: scale(1); }
      50% { transform: scale(1.2); }
      100% { transform: scale(1); }
    }

    .transcription-box {
      margin-top: 20px;
      width: 300px;
      height: 200px;
      border: 1px solid #ccc;
      overflow-y: auto;
      padding: 10px;
    }

    .transcription {
      font-size: 14px;
      line-height: 1.5;
    }

    .answer-box {
      margin-top: 20px;
      width: 300px;
      height: 200px;
      border: 1px solid #ccc;
      overflow-y: auto;
      padding: 10px;
    }

    .answer {
      font-size: 14px;
      line-height: 1.5;
    }
  </style>
</head>
<body>
  <div class="container">
    <button class="record-button" onclick="toggleRecording()">Record</button>
    <div class="transcription-box">
      <p class="transcription" id="transcription"></p>
    </div>
    <button class="fetch-button" onclick="fetchTranscription()">Fetch Transcription</button>
    <div class="answer-box">
      <p class="answer" id="answer"></p>
    </div>
  </div>

  <script>
    // Initialize the SpeechRecognition API
    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition || window.mozSpeechRecognition || window.msSpeechRecognition)();
    recognition.continuous = true;

    // Create a variable to store the transcription
    let transcription = '';

    // Get the record button element
    const recordButton = document.querySelector('.record-button');
    const transcriptionBox = document.querySelector('.transcription');
    const fetchButton = document.querySelector('.fetch-button');
    const answerBox = document.querySelector('.answer');

    // Flag to keep track of recording state
    let isRecording = false;

    // Function to toggle recording and animation
    function toggleRecording() {
      if (isRecording) {
        stopRecording();
        recordButton.classList.remove('recording');
        recordButton.innerText = 'Record';
      } else {
        startRecording();
        recordButton.classList.add('recording');
        recordButton.innerText = 'Recording...';
      }
    }

    // Function to start recording and transcribe user speech
    function startRecording() {
      transcription = '';
      transcriptionBox.innerText = '';
      answerBox.innerText = '';

      recognition.start();
      recognition.onresult = function(event) {
        const currentTranscript = event.results[event.results.length - 1][0].transcript;
        transcription += currentTranscript;
        transcriptionBox.innerText = transcription;
      };
      isRecording = true;
    }

    // Function to stop recording
    function stopRecording() {
      recognition.stop();
      isRecording = false;
    }

    // Function to fetch the transcription text
    // Function to fetch the transcription text and provide an answer
async function fetchTranscription() {
  const question = transcriptionBox.innerText.trim();
  if (!question) {
    return; // If the question is empty, do not proceed
  }

  try {
    const response = await fetch('your-api-url', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify({ question: question })
    });

    const data = await response.json();
    const answer = data.answer; // Assuming the API response has a property named 'answer'
    answerBox.innerText = answer;

    // Update the second box with the text from the first box
    secondBox.innerText = question;
  } catch (error) {
    console.log('Error:', error);
    answerBox.innerText = 'An error occurred while fetching the answer.';
  }
}

  </script>
</body>
</html>
